- alias: Heating - Night
  trigger:
    platform: time
    at: '22:30:00'
  action:
    - service: script.heating_night

- alias: Heating - Everyone Leaves
  trigger:
    - platform: state
      entity_id: group.everyone
      from: 'home'
      to: 'not_home'
  action:
    - service: script.heating_away

- alias: Heating - Someone Arrives Home
  trigger:
    platform: state
    entity_id: person.jana, person.lubos
    to: 'home'
  action:
    - service: script.heating_back

- alias: Heating - Morning
  trigger:
    platform: time
    at: '6:00:00'
  action:
    - delay: "{{ '00:00:00' if is_state('binary_sensor.workday_sensor', 'on') else '01:30:00' }}"
    - service: script.heating_morning

- alias: Heating - Temperature drop
  trigger:
    platform: state
    entity_id:
      - sensor.living_room_open_window
      - sensor.bedroom_open_window
      - sensor.kitchen_open_window
      - sensor.office_open_window
      - sensor.loft_open_window
    from: 'False'
    to: 'True'
  action:
    - service: script.notify_heating_off
      data_template:
        entityid: '{{trigger.entity_id}}'

- alias: Heating - Close to home
  trigger:
    - platform: zone
      entity_id: person.jana, person.lubos
      zone: zone.extended_home
      event: enter
  action:
    - service: script.heating_close

- alias: Heating - Restart Tado bridge when service goes down
  trigger:
    platform: state
    entity_id:
      - sensor.living_room_link
      - sensor.bedroom_link
      - sensor.kitchen_link
      - sensor.office_link
      - sensor.loft_link
    from: 'ONLINE'
    to: 'OFFLINE'
  action:
    - service: script.restart_tado
